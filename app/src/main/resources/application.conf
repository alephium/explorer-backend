alephium {
explorer {
    # server port
    port = 9090
    port = ${?EXPLORER_PORT}

    # server host
    host = "localhost"
    host = ${?EXPLORER_HOST}

    # ReadOnly = Starts Explorer in read-only mode
    # WriteOnly = Starts Explorer in write-only mode
    # ReadWrite = Starts Explorer in read-write mode
    boot-mode = ReadWrite
    boot-mode = ${?EXPLORER_BOOT_MODE}

    services {
      blockflow-sync = {
        # BlockFlowSync Service is always enabled
        # Sync interval for BlockFlowSyncService
        sync-period = 5 seconds
        sync-period = ${?EXPLORER_SYNC_PERIOD}
      }

      mempool-sync = {
        enable = true,
        enable = ${?EXPLORER_MEMPOOL_SYNC_ENABLE}
        # Sync interval for MempoolSyncService
        sync-period = 5 seconds
        sync-period = ${?EXPLORER_SYNC_PERIOD}
      }

      token-supply = {
        enable = true,
        enable = ${?EXPLORER_TOKEN_SUPPLY_ENABLE}
        # Schedule time for TokenSupplyService
        schedule-time = "02:00"
        schedule-time = ${?EXPLORER_TOKEN_SUPPLY_SERVICE_SCHEDULE_TIME}
      }

      hashrate = {
        enable = ${?EXPLORER_HASHRATE_ENABLE}
        enable = true,
        # Sync interval for HashRateService
        sync-period = 1 hours
        sync-period = ${?EXPLORER_HASH_RATE_SERVICE_SYNC_PERIOD}
      }

      tx-history = {
        enable = ${?EXPLORER_TX_HISTORY_ENABLE}
        enable = true,
        # Sync interval for TransactionHistoryService
        sync-period = 15 minutes
        sync-period = ${?EXPLORER_TRANSACTION_HISTORY_SERVICE_SYNC_PERIOD}
      }

      finalizer = {
        # FinalizerService is always enabled
        # Sync interval for FinalizerService
        sync-period = 10 minutes
        sync-period = ${?EXPLORER_FINALIZER_SERVICE_SYNC_PERIOD}
      }

      holder = {
        enable = true,
        # Schedule time for HolderService
        schedule-time = "04:00"
        sync-period = ${?EXPLORER_HOLDER_SERVICE_SYNC_PERIOD}
        schedule-time = ${?EXPLORER_HOLDER_SERVICE_SCHEDULE_TIME}
      }
    }

    # Cache reloading intervals for BlockCache
    cache-row-count-reload-period = 10 seconds
    cache-block-times-reload-period = 5 seconds
    cache-latest-blocks-reload-period = 5 seconds
    cache-metrics-reload-period = 1 minutes

    #How many transaction can be exported at max
    export-txs-number-threshold = 10000

    #Number of allowed parallelism when using `mapAsync` on streams.
    stream-parallelism = 8
    stream-parallelism = ${?EXPLORER_STREAM_PARALLELISM}

    max-time-intervals {
        amount-history = {
            hourly = 7 days
            hourly = ${?EXPLORER_AMOUNT_HISTORY_MAX_TIME_INTERVAL_HOURLY}
            daily  = 366 days
            daily = ${?EXPLORER_AMOUNT_HISTORY_MAX_TIME_INTERVAL_DAILY}
            weekly = 366 days
            weekly = ${?EXPLORER_AMOUNT_HISTORY_MAX_TIME_INTERVAL_WEEKLY}
        }
        charts = {
            hourly = 30 days
            hourly = ${?EXPLORER_CHARTS_MAX_TIME_INTERVAL_HOURLY}
            daily  = 366 days
            daily = ${?EXPLORER_CHARTS_MAX_TIME_INTERVAL_DAILY}
            weekly = 366 days
            weekly = ${?EXPLORER_CHARTS_MAX_TIME_INTERVAL_WEEKLY}
        },
        export-txs = 366 days
        export-txs = ${?EXPLORER_MAX_TIME_INTERVAL_EXPORT_TXS}
    }

    market {
        chart-symbol-name {
            "ALPH" = "alephium"
        }
        currencies = [
            "btc",
            "eth",
            "usd",
            "eur",
            "chf",
            "gbp",
            "idr",
            "vnd",
            "rub",
            "try",
            "cad",
            "aud",
            "hkd",
            "thb"
        ]
        liquidity-minimum = 100 # in USD
        liquidity-minimum = ${?EXPLORER_MARKET_LIQUIDITY_MINIMUM}
        mobula-uri = "https://production-api.mobula.io/api/1"
        mobula-uri = ${?EXPLORER_MARKET_MOBULA_URI}
        coingecko-uri = "https://api.coingecko.com/api/v3"
        coingecko-uri = ${?EXPLORER_MARKET_COINGECKO_URI}
        token-list-uri = "https://raw.githubusercontent.com/alephium/token-list/master/tokens/mainnet.json"
        token-list-uri = ${?EXPLORER_MARKET_TOKEN_LIST_URI}
        market-chart-days = 365
        market-chart-days = ${?EXPLORER_MARKET_CHART_DAYS}
    }
}

blockflow {
    scheme = "http"
    scheme = ${?BLOCKFLOW_SCHEME}
    host = "127.0.0.1"
    host = ${?BLOCKFLOW_HOST}
    port = 12973
    port = ${?BLOCKFLOW_PORT}

    direct-clique-access = false
    direct-clique-access = ${?BLOCKFLOW_DIRECT_CLIQUE_ACCESS}

    network-id = 0
    network-id = ${?BLOCKFLOW_NETWORK_ID}
    group-num = 4
    api-key = null
    api-key = ${?ALEPHIUM_API_KEY}
}
}

db = {
  profile = "slick.jdbc.PostgresProfile$"
  db {
    connectionPool = "org.alephium.explorer.InstrumentedHikariCP$"
    name     = "explorer"
    name     = ${?DB_NAME}
    host     = "localhost"
    host     = ${?DB_HOST}
    port     = 5432
    port     = ${?DB_PORT}
    url      = "jdbc:postgresql://"${db.db.host}":"${db.db.port}"/"${db.db.name}
    user     = "postgres"
    user     = ${?DB_USER}
    password = "postgres"
    password = ${?DB_PASSWORD}
  }
}
